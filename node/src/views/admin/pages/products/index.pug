extends ../../layouts/default.pug
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/alert.pug

block main
  +alert(5000)

  //- Ná»n cho tiÃªu Ä‘á»
  .bg-light.py-3.mb-4
    h1.mb-0.text-primary.text-center(style="text-shadow: 2px 2px 8px #aaa;") Danh SÃ¡ch Sáº£n Pháº©m

  .card.mb-4.shadow
    .card-body
      .row.mb-3
        .col-md-6.mb-2
          +filter-status(filterStatus)
        .col-md-6.mb-2
          +search(keyword)

      .card.mb-3.border-0.bg-light
        .card-header.bg-white.font-weight-bold Sáº¯p xáº¿p
        .card-body.py-2
          .row
            .col-md-4.mb-2
              div(sort)
                select.form-control(name="sort" sort-select)
                  option(value="position-desc") ðŸ¡» Vá»‹ trÃ­ giáº£m dáº§n
                  option(value="position-asc") ðŸ¡¹ Vá»‹ trÃ­ tÄƒng dáº§n
                  option(value="price-desc") ðŸ¡» GiÃ¡ giáº£m dáº§n
                  option(value="price-asc") ðŸ¡¹ GiÃ¡ tÄƒng dáº§n
                  option(value="title-asc") A â†’ Z
                  option(value="title-desc") Z â†’ A
                button.btn.btn-outline-danger.mt-2(sort-clear) XÃ³a lá»c

      form(
        action=`${prefixAdmin}/products/change-multi?_method=PATCH`
        method="POST"
        form-change-multi
        class="mb-3"
      )
        .row.align-items-center
          .col-md-4.mb-2
            .form-group.mb-0.mr-2
              select.form-control(name='type')
                option(value="", selected) Chá»n hÃ nh Ä‘á»™ng
                option(value="active") KÃ­ch hoáº¡t
                option(value="inactive") VÃ´ hiá»‡u hÃ³a
                option(value="delete-all") XÃ³a nhiá»u
                option(value="update-position") Cáº­p nháº­t vá»‹ trÃ­
          .col-md-2.mb-2
            button.btn.btn-danger.w-100(type="submit")
              i.fas.fa-check.mr-1
              | Ãp dá»¥ng
          .col-md-4.mb-2
            .form-group.mb-0.mr-2
              input.form-control.d-none(type="text", name="ids", value="")
          .col-md-2.text-right.mb-2
            a.btn.btn-info(href=`${prefixAdmin}/products/create`)
              i.fas.fa-plus.mr-1
              | ThÃªm sáº£n pháº©m

      .table-responsive
        table.table.table-hover.table-striped.table-bordered.align-middle(multiTable)
          thead.thead-dark
            tr
              th.text-center
                input(type="checkbox" name="check-all")
              th.text-center STT
              th.text-center HÃ¬nh áº£nh
              th.text-center TiÃªu Ä‘á»
              th.text-center GiÃ¡
              th.text-center Vá»‹ trÃ­
              th.text-center Tráº¡ng ThÃ¡i
              th.text-center HÃ nh Äá»™ng
          tbody
            each item, index in products
              tr
                td.text-center
                  input(type="checkbox" name="id" value=item.id)
                td.text-center #{index + 1}
                td.text-center
                  img(src=item.thumbnail, alt="Sáº£n pháº©m", width="80px", height="auto", class="img-thumbnail")
                td #{item.title}
                td.text-right.text-success #{item.price}
                td.text-center
                  input(
                    type="number"
                    value=item.position
                    style="width: 60px"
                    name="position"
                    min="1"
                    class="form-control form-control-sm d-inline-block"
                  )
                td.text-center
                  if item.status == 'active'
                    a.btn.btn-outline-success.btn-sm(
                      href="javascript:;"
                      data-id=item.id
                      data-status=item.status
                      button-change-status
                    )
                      i.fas.fa-toggle-on.mr-1
                      | ON
                  else
                    a.btn.btn-outline-secondary.btn-sm(
                      href="javascript:;"
                      data-id=item.id
                      data-status=item.status
                      button-change-status
                    )
                      i.fas.fa-toggle-off.mr-1
                      | OFF
                td.text-center
                  a.btn.btn-primary.btn-sm.px-2.mr-2(
                    type="button"
                    href=`${prefixAdmin}/products/edit/${item.id}`
                  )
                    i.fas.fa-edit.mr-1
                    | Sá»­a
                  a.btn.btn-warning.btn-sm.px-2.mr-2(
                    type="button"
                    href=`${prefixAdmin}/products/detail/${item.id}`
                  )
                    i.fas.fa-info-circle.mr-1
                    | Chi tiáº¿t
                  button.btn.btn-danger.btn-sm.px-2(
                    type="button"
                    data-id=item.id
                    data-toggle="modal"
                    data-target="#exampleModal"
                    button-delete
                    button-delete-product
                  )
                    i.fas.fa-trash.mr-1
                    | XÃ³a

      //- Pagination
      if pagination && pagination.totalPage > 1
        nav(aria-label="Page navigation")
          ul.pagination.justify-content-center
            if pagination.currentPage > 1
              li.page-item
                button.page-link(button-pagination=pagination.currentPage-1) Â«
            - for (var i = 1; i <= pagination.totalPage; i++)
              li(class=`page-item${pagination.currentPage == i ? " active" : ""}`)
                button.page-link(button-pagination=i) #{i}
            if pagination.currentPage < pagination.totalPage
              li.page-item
                button.page-link(button-pagination=pagination.currentPage+1) Â»

  form(
    action=""
    method="POST"
    id="form-change-status"
    data-path=`${prefixAdmin}/products/change-status`
  )

  form(
    action=""
    method="POST"
    id="form-delete-product"
    data-path=`${prefixAdmin}/products/delete`
  )

  //- FontAwesome CDN (náº¿u chÆ°a cÃ³ trong layout)
  link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css")

  script(src="/admin/js/products.js")
  script(src="/admin/js/script.js")
